<!doctype html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="./style.css" />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Setup</title>
    </head>

    <body>
        <div class="container">
            <div class="setup-top">
                <h3 class="title" id="setupTitle">Setup</h3>
                <a class="btn linkbtn" href="./index.html">Back to HMI</a>
                <button class="btn" id="logoutBtn">Logout</button>
            </div>

            <div class="setup-layout">
                <aside class="setup-sidebar">
                    <div class="setup-nav">
                        <button class="setup-navbtn" data-view="general">General</button>
                        <button class="setup-navbtn" data-view="security">Security</button>
                        <button class="setup-navbtn" data-view="relays">Relays</button>
                        <button class="setup-navbtn" data-view="dis">Digital Inputs</button>
                        <button class="setup-navbtn" data-view="values">Values</button>
                        <button class="setup-navbtn" data-view="export">Export / Import</button>
                    </div>
                </aside>

                <main class="setup-content">
                    <div class="panel" id="setupStatusPanel" style="display:none;">
                        <div class="panel-h">Status</div>
                        <div id="setupStatusText"></div>
                    </div>

                    <div class="panel setup-view" data-view="general">
                        <div class="panel-h">General</div>

                        <div class="field">
                            <label for="cfgTitle">Page Title</label>
                            <input class="input" id="cfgTitle" type="text" />
                            <div class="hint">Shown at the top of the main HMI page.</div>
                        </div>
                    </div>

                    <div class="panel setup-view" data-view="security" style="display:none;">
                        <div class="panel-h">Security</div>

                        <div class="field">
                            <label for="oldPass">Old Password</label>
                            <input class="input" id="oldPass" type="password" autocomplete="current-password" />
                        </div>

                        <div class="field">
                            <label for="authUser">Username</label>
                            <input class="input" id="newUser" type="text" autocomplete="username" />
                            <div class="hint">Required to access /setup.html.</div>
                        </div>

                        <div class="field">
                            <label for="authPass">Password</label>
                            <input class="input" id="newPass" type="password" autocomplete="new-password" />
                            <div class="hint">Store this somewhere safe. This is dev/LAN-grade auth.</div>
                        </div>

                        <button class="btn" id="changeCredsBtn">Apply Credential Change</button>
                    </div>

                    <div class="panel setup-view" data-view="relays" style="display:none;">
                        <div class="panel-h">Relays</div>
                        <div id="relayList"></div>

                        <div class="btnrow2">
                            <button class="btn" id="addRelayBtn">Add Relay</button>
                            <button class="btn" id="resetRelaysBtn">Reset to 4</button>
                        </div>
                        <div class="hint">Relay count controls how many relay panels exist and which /api/relay/N endpoints are valid.</div>
                    </div>

                    <div class="panel setup-view" data-view="dis" style="display:none;">
                        <div class="panel-h">Digital Inputs</div>
                        <div id="diList"></div>

                        <div class="btnrow2">
                            <button class="btn" id="addDiBtn">Add DI</button>
                            <button class="btn" id="resetDiBtn">Reset to 4</button>
                        </div>
                        <div class="hint">DI count controls how many digitalInputN fields are emitted from /customState.json.</div>
                    </div>

                    <div class="panel setup-view" data-view="values" style="display:none;">
                        <div class="panel-h">Values</div>
                        <div id="valueList"></div>
                        <div class="hint">These are key/value readouts. Keys must match your /customState.json fields (e.g. vin, register1, oneWire1).</div>

                        <div class="btnrow2">
                            <button class="btn" id="addValueBtn">Add Value</button>
                            <button class="btn" id="resetValuesBtn">Reset defaults</button>
                        </div>
                    </div>

                    <div class="panel setup-view" data-view="export" style="display:none;">
                        <div class="panel-h">Export / Import</div>

                        <div class="field">
                            <label for="cfgJson">Config JSON</label>
                            <textarea class="input" id="cfgJson" rows="10" spellcheck="false"></textarea>
                            <div class="hint">You can copy/paste config JSON to move setups between machines.</div>
                        </div>

                        <div class="btnrow2">
                            <button class="btn" id="reloadJsonBtn">Reload</button>
                            <button class="btn" id="applyJsonBtn">Apply JSON</button>
                        </div>
                    </div>

                    <div class="setup-actions">
                        <button class="btn" id="saveBtn">Save</button>
                        <button class="btn" id="reloadBtn">Reload from Device</button>
                    </div>
                </main>
            </div>
        </div>

        <script type="module" src="./setup.js"></script>
    </body>
</html>
